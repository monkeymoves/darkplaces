<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" type="text/css" href="main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>

<body>
  <div class="header">
    <a href="./index.html"><img src='./img/dsw.jpg' alt="logo" /></a>
    <a href="#default" class="logo">Dark Sky Wales Locations</a>
    <div class="header-right">
      <a class="active" href="#home">Home</a>
      <a href="#weather">Weather</a>
      <!-- <a href="#about">About</a> -->
    </div>
  </div>

  <div id="map"></div>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title"></h4>
        </div>
        <div class="modal-body">
          <p id="myModal1"> </p>
          <p id="myModal2"> </p>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>



  <script>


    let telescopeIcon = src = './img/smalltelescope.png'
    let binoIcon = src = './img/binos.png'
    let reserveIcon = src = './img/reserve.png'


    var map;
    function initMap() {
      map = new google.maps.Map(document.getElementById('map'), {
        styles: [
          {
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#1d2c4d"
              }
            ]
          },
          {
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#8ec3b9"
              }
            ]
          },
          {
            "elementType": "labels.text.stroke",
            "stylers": [
              {
                "color": "#1a3646"
              }
            ]
          },
          {
            "featureType": "administrative.country",
            "elementType": "geometry.stroke",
            "stylers": [
              {
                "color": "#4b6878"
              }
            ]
          },
          {
            "featureType": "administrative.land_parcel",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#64779e"
              }
            ]
          },
          {
            "featureType": "administrative.province",
            "elementType": "geometry.stroke",
            "stylers": [
              {
                "color": "#4b6878"
              }
            ]
          },
          {
            "featureType": "landscape.man_made",
            "elementType": "geometry.stroke",
            "stylers": [
              {
                "color": "#334e87"
              }
            ]
          },
          {
            "featureType": "landscape.natural",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#023e58"
              }
            ]
          },
          {
            "featureType": "poi",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#283d6a"
              }
            ]
          },
          {
            "featureType": "poi",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#6f9ba5"
              }
            ]
          },
          {
            "featureType": "poi",
            "elementType": "labels.text.stroke",
            "stylers": [
              {
                "color": "#1d2c4d"
              }
            ]
          },
          {
            "featureType": "poi.park",
            "elementType": "geometry.fill",
            "stylers": [
              {
                "color": "#023e58"
              }
            ]
          },
          {
            "featureType": "poi.park",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#3C7680"
              }
            ]
          },
          {
            "featureType": "road",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#304a7d"
              }
            ]
          },
          {
            "featureType": "road",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#98a5be"
              }
            ]
          },
          {
            "featureType": "road",
            "elementType": "labels.text.stroke",
            "stylers": [
              {
                "color": "#1d2c4d"
              }
            ]
          },
          {
            "featureType": "road.arterial",
            "elementType": "labels",
            "stylers": [
              {
                "visibility": "off"
              }
            ]
          },
          {
            "featureType": "road.highway",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#2c6675"
              }
            ]
          },
          {
            "featureType": "road.highway",
            "elementType": "geometry.stroke",
            "stylers": [
              {
                "color": "#255763"
              }
            ]
          },
          {
            "featureType": "road.highway",
            "elementType": "labels",
            "stylers": [
              {
                "visibility": "off"
              }
            ]
          },
          {
            "featureType": "road.highway",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#b0d5ce"
              }
            ]
          },
          {
            "featureType": "road.highway",
            "elementType": "labels.text.stroke",
            "stylers": [
              {
                "color": "#023e58"
              }
            ]
          },
          {
            "featureType": "road.local",
            "stylers": [
              {
                "visibility": "off"
              }
            ]
          },
          {
            "featureType": "transit",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#98a5be"
              }
            ]
          },
          {
            "featureType": "transit",
            "elementType": "labels.text.stroke",
            "stylers": [
              {
                "color": "#1d2c4d"
              }
            ]
          },
          {
            "featureType": "transit.line",
            "elementType": "geometry.fill",
            "stylers": [
              {
                "color": "#283d6a"
              }
            ]
          },
          {
            "featureType": "transit.station",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#3a4762"
              }
            ]
          },
          {
            "featureType": "water",
            "elementType": "geometry",
            "stylers": [
              {
                "color": "#0e1626"
              }
            ]
          },
          {
            "featureType": "water",
            "elementType": "labels.text.fill",
            "stylers": [
              {
                "color": "#4e6d70"
              }
            ]
          }
        ],
        zoom: 8.2,
        center: new google.maps.LatLng(52.2, -3.6),
        mapTypeControl: false,
        streetViewControl: false,
        zoomControl: true,
        zoomControlOptions: {
            position: google.maps.ControlPosition.TOP_LEFT
        },
        // mapTypeControlOptions: {
        //   style: google.maps.MapTypeControlStyle.HORIZONTAL_BAR,
        //   position: google.maps.ControlPosition.TOP_LEFT,
        // },
        // mapTypeId: 'terrain',
      });
      // Create a <script> tag and set the data as the source.
      var script = document.createElement('script');
      script.src = 'data.js';
      document.getElementsByTagName('head')[0].appendChild(script);
    }
    
    function siteElement(x){
      let icon = telescopeIcon
      if (x == 'Orion'){
        icon = binoIcon
      } else if (x == "International Dark Sky Reserve"){
        icon = reserveIcon
      }
      return icon
    }

    // Loop through the results array and place a marker for each
    // set of coordinates.

    window.DSWsite_callback = function (results) {
      for (var i = 0; i < results.features.length; i++) {
        let coords = results.features[i].geometry.coordinates;
        let name = results.features[i].properties.name
        let description = results.features[i].properties.description
        let siteClass = results.features[i].properties.siteClass
        let webby = results.features[i].properties.website



        let latLng = new google.maps.LatLng(coords[1], coords[0]);
        let marker = new google.maps.Marker({
          position: latLng,
          map: map,
          icon: siteElement(results.features[i].properties.siteClass),
          title: results.features[i].properties.name
        });
        /*Google Map Marker Click Function*/
        google.maps.event.addListener(marker, 'click', (function (marker) {
          return function () {
            /*Bootstrap Modal Pop Up Open Code*/
            $(".modal-title").text(name);
            $(".modal-body").text("This site has the viewing class of " + siteClass);
            $(".modal-body").append('</br></br>'+ description);
            $(".modal-body").append('</br></br> <a href=' +'"'+ webby +'"' + '>Visit Site    </a>'+webby);
            $("#myModal").modal('show');
          }
        })(marker));


      }

    }



  </script>


  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBIIvoo3p_X28uIYfkETl7-kZkLH7p5cRA&callback=initMap"
    async defer></script>

</body>

</html>